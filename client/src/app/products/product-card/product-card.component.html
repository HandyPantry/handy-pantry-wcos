<mat-card class="product-card" *ngIf="this.product">
  <div>
    <mat-card-header>
      <mat-card-title class="product-card-name">{{this.product.product_name}}</mat-card-title>
    </mat-card-header>
    <hr>
  </div>
  <form *ngIf="formExists"[formGroup]="changeProductForm" (ngSubmit)="submitForm();">
  <mat-card-content  class="cardInfo">

    <b>Brand:</b>
    <div>
      <mat-form-field>
        <mat-label>Brand</mat-label>
        <input matInput placeholder="Brand" required formControlName="brand" data-test="brandInput">
        <mat-error *ngFor="let validation of changeProductFormMessages.brand">
          <mat-error class="error-message" data-test="brandError"
            *ngIf="changeProductForm.get('brand').hasError(validation.type) && (changeProductForm.get('brand').dirty || changeProductForm.get('brand').touched)">
            {{validation.message}}
          </mat-error>
        </mat-error>
      </mat-form-field>
    </div>

    <b>Store:</b>
    <div>
      <mat-form-field>
        <mat-label>Store</mat-label>
        <mat-select formControlName="store" data-test="storeDropDown">
          <mat-option data-test="clickWillies" value="Willies">Willies</mat-option>
          <mat-option data-test="clickCoop" value="Pomme de Terre Food Coop">Pomme de Terre Food Coop
          </mat-option>
          <mat-option data-test="clickOther" value="Other">Other</mat-option>
        </mat-select>
        <mat-error data-test="storeError" *ngIf="changeProductForm.get('store').hasError('required')">You must
          make a
          selection</mat-error>
        <mat-error
          *ngIf="changeProductForm.get('store').hasError('pattern') && !changeProductForm.get('store').hasError('required')">
        </mat-error>
      </mat-form-field>
    </div>

    <b>Category:</b>
    <div>
      <mat-form-field>
        <mat-label>Category</mat-label>
        <mat-select formControlName="category" data-test="categoryDropDown">
          <mat-option data-test="clickGoods" value="Baked Goods">Baked Goods</mat-option>
          <mat-option data-test="clickBake" value="Baking Supplies">Baking Supplies</mat-option>
          <mat-option data-test="clickBev" value="Beverages">Beverages</mat-option>
          <mat-option data-test="clickCleaning" value="Cleaning Products">Cleaning Products</mat-option>
          <mat-option data-test="clickDairy" value="Dairy">Dairy</mat-option>
          <mat-option data-test="clickDeli" value="Deli">Deli</mat-option>
          <mat-option data-test="clickFrozen" value="Frozen Foods">Frozen Foods</mat-option>
          <mat-option data-test="clickHerbs" value="Herbs and Spices">Herbs and Spices</mat-option>
          <mat-option data-test="clickMeat" value="Meat">Meat</mat-option>
          <mat-option data-test="clickPaper" value="Paper Products">Paper Products</mat-option>
          <mat-option data-test="clickPet" value="Pet Supplies">Pet Supplies</mat-option>
          <mat-option data-test="clickProduce" value="Produce">Produce</mat-option>
          <mat-option data-test="clickStaples" value="Staples">Staples</mat-option>
          <mat-option data-test="clickToilet" value="Toiletries">Toiletries</mat-option>
          <mat-option data-test="clickMisc" value="Miscellaneous>">Miscellaneous</mat-option>
        </mat-select>
        <mat-error data-test="categoryError" *ngIf="changeProductForm.get('category').hasError('required')">
          You must make a
          selection</mat-error>
        <mat-error
          *ngIf="changeProductForm.get('category').hasError('pattern') && !changeProductForm.get('category').hasError('required')">
        </mat-error>
      </mat-form-field>
    </div>

    <b>Location:</b>
    <div>
      <mat-form-field>
        <mat-label>Location</mat-label>
        <input matInput placeholder="Location" formControlName="location" data-test="locationInput">
        <mat-error *ngFor="let validation of changeProductFormMessages.threshold">
          <mat-error class="error-message" data-test="locationError"
            *ngIf="changeProductForm.get('location').hasError(validation.type) && (changeProductForm.get('location').dirty || changeProductForm.get('location').touched)">
            {{validation.message}}
          </mat-error>
        </mat-error>
      </mat-form-field>
    </div>

    <b>Lifespan:</b>
    <div>
      <mat-form-field>
        <mat-label>Lifespan</mat-label>
        <input matInput placeholder="Lifespan" formControlName="lifespan" data-test="lifespanInput">
        <mat-error *ngFor="let validation of changeProductFormMessages.lifespan">
          <mat-error class="error-message" data-test="lifespanError"
            *ngIf="changeProductForm.get('lifespan').hasError(validation.type) && (changeProductForm.get('lifespan').dirty || changeProductForm.get('lifespan').touched)">
            {{validation.message}}
          </mat-error>
        </mat-error>
      </mat-form-field>
    </div>

    <b>Threshold:</b>
    <div>
      <mat-form-field>
        <mat-label>Threshold</mat-label>
        <input matInput placeholder="Threshold" formControlName="threshold" data-test="thresholdInput">
        <mat-error *ngFor="let validation of changeProductFormMessages.threshold">
          <mat-error class="error-message" data-test="thresholdError"
            *ngIf="changeProductForm.get('threshold').hasError(validation.type) && (changeProductForm.get('threshold').dirty || changeProductForm.get('threshold').touched)">
            {{validation.message}}
          </mat-error>
        </mat-error>
      </mat-form-field>
    </div>

    <div>
      <b>Description:</b>
      <div>
        <textarea matInput placeholder="Description" name="Description" cols="40" rows="5"
        formControlName="description" data-test="descriptionInput"></textarea>
      </div>
    </div>

    <div>
      <b>Notes:</b>
      <div>
        <textarea matInput placeholder="Notes" name="Notes" cols="40" rows="5" formControlName="notes"
        data-test="notesInput"></textarea>
      </div>
    </div>
  </mat-card-content>

  <mat-card-actions align="start">
    <button mat-button type="button" color="primary" [disabled]="!changeProductForm.valid" type="submit"
      data-test="confirmChange">
      Change Product
    </button>
  </mat-card-actions>
</form>
  <mat-card-actions class="add-to-pantry">
    <button color="primary" mat-raised-button type="button" (click)="popup = true" data-test="addToPantryButton"> Add
      Product To Pantry</button>
  </mat-card-actions>
</mat-card>

<div class="overlay" *ngIf="popup">
  <div class="popup">
    <h2>Add This Product to Your Pantry</h2>
    <a class="close" (click)="popup = false">&times;</a>
    <app-add-product-to-pantry [product]="this.product"></app-add-product-to-pantry>
  </div>
</div>
